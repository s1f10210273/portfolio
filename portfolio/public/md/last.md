# バイナリ解析

## CPUの命令

```
| bit7 | bit6 | bit5 | bit4 | bit3 | bit2 | bit1 | bit0 |
```

- 上位4bitは命令の種類を示すオペレーションコードである。
- 下位4bitはイミディエイトデータである。
### 命令の種類
- `MOV` : `0011 xxxx`
    データの内容を手帳に書き込め
- `ADD` : `0000 xxxx`
    データの内容と手帳に書かれている内容を足せ
- `JMP` : `1111 xxxx`
    データの内容のマス目に移動しろ
- `JNC` : `1110 xxxx`
    特定の条件を除き、データの内容のマス目に移動しろ
___

## ASCIIコード
![スクリーンショット 2024-01-18 15.06.13](https://i.imgur.com/GB0bhyw.png)
例えば、0を表現するためのASCIIコードは`0x30`となる。

___
## メモリの格納
メモリの格納方法には、データを上から詰めていく(ビックエンディアン)と、下から詰めていく(リトルエンディアン)の2種類がある。

- **ビックエンディアン**
    - 複数のバイトデータをそのまま先頭から格納する方法
    - 利点としては、直感的な順番で格納されているため、データの大きさや正負の符号が予測しやすい

- **リトルエンディアン**
    - 複数のバイトデータを末尾のバイトから、アドレスの先頭に格納する方法
    - 末尾のバイトが最初に格納される性質のため、データの長さが変化した場合でも、アドレスが変わることなくアクセスできる。また、末尾のバイトが先頭に来るため、データの長さがわからない場合でもデータを読みやすい。


___
## メモリとスタック領域
プログラム部には、実行するプログラムの情報、バイナリコードが格納されている。
スタック部には、プログラムの中で宣言した変しいの情報などが格納されている。

### データスタック構造
- **スタックデータ構造**
    複数のデータを管理するときに、本を山にして積み重ねていくように、さいごに追加したデータを最初に取り出すような管理の仕方を、スタックデータ構造という。

- **push・pop**
    スタックデータ構造にデータを追加することをpush、取り出すことをpopという。


### レジスタ
CPUがデータの処理をしている本体で、メモリが処理中のデータを一時的に保存している場所だ。
実は、CPU内部にも記憶装置が存在し、それが**レジスタ**と呼ぶ。

CPUはメモリから必要な情報を読み取ったり書き込んだりして、データの処理を行う。しかし、データの処理の際に頻繁に使う値をいちいちメモリから参照していると時間がかかってしまう。
そのため、保存できるデータの量がかなり少ないものの、その分高速に動作するレジスタという記憶装置をCPU内部に搭載し、処理効率を上げている。

レジスタには、様々な種類があり、それぞれ異なる役割を果たしている。

- **汎用レジスタ**
    汎用レジスタは、特に使い方が指定されておらず、状況に応じて様々な用途に用いられるレジスタだ。
    とはいえ、どういった使い方をするかはある程度統一された暗黙のルールがある。
    |略称|名称|中身|
    |---|---|---|
    |`EAX`|アキュムレータレジスタ|計算結果などの返り値|
    |`EBX`|ベースレジスタ|アドレスのベース値|
    |`ECX`|カウンタレジスタ|ループの回数のカウントなど|
    |`EDX`|データレジスタ|演算に用いるデータ|

    略称の最初の`E`は、このレジスタが32bit使用であることを表している。64bitの場合、頭文字は`R`となる。

- **特殊レジスタ**
    特殊レジスタは、汎用レジスタとは異なり各々に特有の用途がある。
    |略称|名称|中身|
    |---|---|---|
    |`ESP`|スタックポインタ|実行中の関数のスタックのトップを常に指す|
    |`EBP`|スタックベースポインタ|実行中の関数のスタックのボトムを常に指す|
    |`EIP`|インストラクションポインタ|メモリのプログラム部の、次に実行する命令のアドレスを常に格納している|

    ポインタとはメモリに格納されているデータのアドレスを記録したものである。

[aaa](https://developer.mozilla.org/en)

